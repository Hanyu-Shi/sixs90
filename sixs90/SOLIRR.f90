subroutine solirr (wl,swl)

!     si (in w/m2/micron) contains the values of the solar
!     irradiance between 0.25 and 4.0 microns, by step of 0.0025 m.
!     the value of the total irradiance is 1372 w/m2 on the whole
!     spectrum (1358 w/m2 between 0.25 and 4.0 microns). Thuillier solar 
!     spectrum (Thuillier et al., 2003)is between 0.25 and 2.3975. The Committee
!     on Earth Observation Satellites (CEOS)Working Group on Calibration and
!     Validation (WGCV) recommends using this spectrum for applications in
!     optical-based Earth Observation that use an exoatmospheric solar
!     irradiance spectrum. The Thuillier spectrum is believed to be the most
!     accurate and an improvement over the other solar spectrum
!

    implicit none
    dimension si(1501)
    logical:: ier
    real(8) :: wl,swl,si,pas
    integer :: iwr,i,iwl
    common/sixs_ier/iwr,ier

    data (si(i),i=1,112) /                                      &
      60.53,  41.05,  65.48, 124.82,  91.18, 103.89, 243.19,    &
     253.44, 261.08, 200.10, 143.82, 241.11,  78.51, 294.57,    &
     172.07, 349.28, 546.91, 521.54, 518.14, 507.20, 447.89,    &
     474.38, 635.70, 633.29, 512.25, 690.60, 675.84, 805.72,    &
     775.51, 717.64, 819.93, 969.07,1142.42,1004.12,1028.25,    &
     888.80,1078.92,1049.70, 945.34, 969.85,1021.85,1030.19,    &
    1162.23, 891.29,1042.36,1063.06,1149.70,1258.97,1276.68,    &
    1130.96,1026.56,1305.68,1171.38, 871.91,1036.76,1055.60,    &
    1230.66,1025.04,1146.60,1094.21,1739.18,1862.33,1747.51,    &
    1686.05,1648.55,1702.68,1762.60,1740.57,1716.71,1731.94,    &
    1731.00,1646.71,1360.55,1684.47,1660.80,1769.49,1824.85,    &
    1954.82,1945.83,2006.31,2091.29,2030.63,2067.89,2119.47,    &
    2054.87,2118.79,2020.21,2002.85,1985.71,2087.35,2100.24,    &
    2111.23,2094.62,2077.29,1937.35,1869.08,2026.04,1943.63,    &
    2033.89,1976.76,1933.93,1897.69,1957.79,1983.97,1898.67,    &
    1905.78,1849.84,1621.80,1812.98,1818.90,1896.27,1757.37/
    data (si(i),i=113,224) /                                    &
    1892.09,1886.49,1880.53,1866.72,1805.46,1850.26,1878.48,    &
    1854.86,1879.38,1870.01,1882.64,1803.69,1767.56,1785.57,    &
    1793.63,1806.58,1783.84,1832.46,1801.42,1800.84,1798.24,    &
    1824.26,1791.71,1792.69,1693.47,1767.25,1756.89,1764.90,    &
    1742.80,1716.17,1747.41,1721.88,1686.83,1683.58,1669.34,    &
    1635.24,1674.74,1656.05,1623.34,1671.77,1643.19,1635.95,    &
    1630.40,1644.03,1600.15,1602.35,1589.42,1593.50,1570.38,    &
    1576.49,1511.68,1457.29,1539.89,1545.07,1535.77,1517.23,    &
    1516.04,1500.44,1487.16,1483.62,1476.74,1469.11,1447.72,    &
    1462.35,1474.88,1458.56,1444.21,1431.85,1442.87,1425.93,    &
    1440.97,1418.26,1401.80,1373.39,1363.92,1369.00,1353.52,    &
    1349.52,1344.41,1337.90,1323.01,1324.26,1315.27,1301.95,    &
    1273.08,1273.91,1285.85,1289.21,1266.83,1262.69,1269.27,    &
    1272.12,1262.42,1242.20,1249.58,1235.28,1225.65,1219.58,    &
    1191.41,1163.90,1160.26,1162.27,1156.21,1151.51,1155.58,    &
    1124.40,1122.89,1133.11,1116.51,1119.05,1102.16,1107.93/
    data (si(i),i=225,336) /                                    &
    1097.13,1112.48,1103.70,1088.33,1060.02,1073.83,1066.41,    &
    1068.32,1054.45,1035.78,1035.81,1033.47,1038.49,1011.40,    &
    1023.27,1001.34, 916.75, 973.54, 888.10, 969.81, 977.24,    &
    1009.15, 959.96, 950.91, 970.44, 971.36, 934.79, 961.73,    &
     954.44, 934.80, 946.41, 921.83, 932.94, 904.97, 896.41,    &
     901.87, 889.18, 878.22, 904.52, 890.73, 871.69, 873.62,    &
     868.53, 860.41, 862.25, 831.58, 844.68, 856.31, 845.63,    &
     841.61, 834.17, 835.59, 825.86, 823.50, 811.69, 818.71,    &
     814.05, 806.74, 750.37, 786.84, 790.79, 778.43, 781.99,    &
     773.31, 778.15, 772.86, 763.92, 764.42, 756.14, 756.53,    &
     751.40, 746.11, 737.31, 742.80, 735.56, 734.09, 726.41,    &
     724.33, 670.61, 716.55, 714.96, 707.29, 698.15, 703.09,    &
     689.27, 689.75, 692.12, 689.71, 684.44, 676.97, 666.68,    &
     661.87, 663.12, 660.19, 660.97, 654.80, 654.74, 652.65,    &
     651.53, 648.52, 641.34, 637.48, 640.64, 636.28, 616.44,    &
     620.33, 609.66, 624.75, 622.51, 594.50, 612.14, 588.02/
    data (si(i),i=337,448) /                                    &
     606.15, 598.48, 580.54, 583.41, 592.04, 577.47, 585.33,    &
     580.80, 581.33, 573.11, 573.55, 573.98, 562.31, 567.57,    &
     552.66, 555.22, 547.16, 553.55, 552.08, 542.32, 538.47,    &
     537.23, 538.15, 541.19, 536.01, 530.38, 534.30, 530.19,    &
     517.42, 524.69, 519.64, 517.52, 513.22, 516.04, 504.21,    &
     506.01, 511.26, 496.95, 504.30, 504.66, 495.35, 498.93,    &
     494.07, 477.69, 484.05, 489.48, 486.07, 485.11, 476.57,    &
     480.66, 479.97, 477.17, 474.80, 470.97, 469.66, 458.15,    &
     465.22, 460.78, 458.36, 459.71, 452.41, 450.55, 453.89,    &
     449.89, 450.06, 443.55, 445.16, 443.09, 443.95, 440.51,    &
     437.17, 434.09, 437.62, 435.78, 433.18, 432.37, 425.06,    &
     378.60, 420.87, 423.79, 418.04, 422.54, 420.48, 416.00,    &
     417.71, 412.43, 412.84, 410.21, 408.25, 393.21, 394.40,    &
     401.58, 402.43, 400.03, 398.98, 396.25, 391.47, 387.77,    &
     392.82, 390.41, 384.18, 387.47, 387.17, 385.22, 379.12,    &
     383.05, 376.04, 375.04, 372.43, 371.84, 373.28, 370.29/
    data (si(i),i=449,560) /                                    &
     366.29, 370.30, 364.62, 365.02, 364.77, 360.37, 360.76,    &
     360.11, 356.43, 358.29, 354.86, 356.82, 347.58, 351.72,    &
     349.56, 349.48, 349.34, 341.26, 345.59, 346.08, 340.94,    &
     335.55, 337.26, 334.56, 332.23, 339.72, 335.96, 335.65,    &
     322.08, 322.62, 327.69, 327.90, 325.76, 324.08, 319.39,    &
     322.42, 322.08, 317.77, 318.02, 317.79, 316.06, 312.07,    &
     309.47, 308.29, 312.81, 308.79, 312.47, 292.00, 308.61,    &
     306.80, 306.91, 303.19, 304.64, 285.76, 275.87, 297.32,    &
     299.24, 292.28, 293.79, 293.18, 292.59, 287.16, 286.45,    &
     290.00, 276.26, 285.46, 282.05, 282.01, 274.52, 278.79,    &
     281.62, 273.00, 273.53, 276.48, 270.75, 273.37, 270.94,    &
     271.81, 271.52, 267.11, 266.47, 268.30, 254.69, 247.82,    &
     265.62, 255.41, 261.64, 254.42, 241.01, 258.79, 260.54,    &
     258.39, 255.48, 252.80, 251.35, 251.39, 238.67, 246.04,    &
     244.91, 243.57, 238.54, 243.90, 243.48, 246.10, 242.16,    &
     241.31, 240.36, 230.94, 227.61, 228.49, 227.77, 232.02/
    data (si(i),i=561,672) /                                    &
     230.10, 230.58, 229.62, 230.98, 229.91, 229.06, 226.25,    &
     223.47, 225.91, 216.10, 217.90, 218.06, 208.20, 208.63,    &
     215.71, 214.90, 213.45, 216.38, 215.38, 213.79, 210.84,    &
     208.53, 210.55, 205.31, 206.92, 205.76, 208.08, 205.46,    &
     203.52, 200.36, 201.65, 200.51, 201.24, 192.59, 189.25,    &
     185.66, 193.66, 194.35, 192.83, 190.88, 190.99, 191.05,    &
     190.66, 191.21, 189.51, 184.31, 186.67, 185.25, 183.73,    &
     184.58, 182.46, 178.21, 180.05, 178.66, 177.21, 179.78,    &
     178.13, 176.90, 176.47, 175.72, 175.60, 171.65, 174.35,    &
     172.49, 172.40, 170.51, 166.93, 154.14, 163.46, 162.87,    &
     167.27, 166.94, 165.96, 163.65, 164.64, 162.57, 162.43,    &
     158.48, 160.97, 154.77, 161.09, 158.99, 158.49, 159.34,    &
     155.72, 155.54, 155.28, 152.26, 154.45, 148.86, 132.64,    &
     145.86, 149.29, 151.11, 148.88, 150.33, 146.90, 144.51,    &
     144.62, 143.89, 144.69, 145.20, 143.85, 142.93, 143.14,    &
     140.60, 141.74, 140.99, 138.32, 140.07, 139.77, 138.02/
    data (si(i),i=673,784) /                                    &
     135.88, 134.65, 136.27, 136.69, 132.94, 131.19, 118.90,    &
     130.03, 129.89, 131.08, 132.92, 132.19, 131.27, 128.54,    &
     128.35, 129.20, 128.89, 124.28, 126.38, 123.99, 123.57,    &
     124.58, 122.44, 122.80, 123.72, 120.95, 121.33, 119.70,    &
     121.12, 119.57, 118.86, 119.59, 119.00, 118.43, 117.77,    &
     117.39, 115.37, 115.03, 115.02, 114.83, 112.12, 114.05,    &
     111.65, 111.28, 112.28, 112.07, 112.05, 111.14, 110.79,    &
     109.28, 109.75, 109.21, 107.80, 106.97, 106.86, 107.29,    &
     105.57, 106.25, 106.45, 105.86, 104.19, 103.81, 103.64,    &
     103.87, 103.32, 100.58, 100.99, 101.47, 101.29, 100.87,    &
     101.06, 100.59,  98.94,  99.42,  99.07,  97.67,  97.36,    &
      97.03,  96.20,  96.31,  96.35,  96.27,  94.82,  95.14,    &
      95.10,  94.94,  94.11,  94.25,  94.01,  93.26,  92.98,    &
      92.67,  91.91,  90.54,  84.81,  85.14,  89.51,  89.82,    &
      89.63,  88.38,  88.83,  88.00,  88.88,  87.35,  86.78,    &
      87.30,  86.69,  86.26,  85.81,  85.39,  84.32,  82.07/
    data (si(i),i=785,896) /                                    &
      83.79,  83.93,  83.38,  82.47,  82.92,  82.48,  81.69,    &
      81.03,  81.34,  81.11,  80.70,  79.74,  79.31,  79.19,    &
      79.22,  78.31,  78.40,  77.90,  76.87,  77.35,  77.23,    &
      75.84,  76.26,  76.19,  75.82,  75.69,  75.12,  75.22,    &
      74.22,  72.91,  73.71,  73.66,  73.37,  72.57,  71.28,    &
      71.21,  71.80,  71.77,  71.44,  71.26,  70.83,  70.73,    &
      69.98,  69.49,  69.63,  67.94,  67.27,  67.95,  67.99,    &
      67.74,  67.33,  67.17,  67.07,  67.24,  66.82,  66.61,    &
      66.36,  64.19,  64.41,  64.28,  64.76,  64.66,  64.41,    &
      64.35,  63.76,  63.36,  62.45,  63.41,  63.01,  61.52,    &
      59.80,  60.56,  61.07,  60.69,  60.57,  60.45,  59.80,    &
      59.82,  59.85,  59.63,  59.40,  59.17,  58.95,  58.73,    &
      58.50,  58.28,  58.06,  57.83,  57.60,  57.37,  57.15,    &
      56.93,  56.70,  56.48,  56.26,  56.03,  55.79,  55.57,    &
      55.36,  55.13,  54.90,  54.66,  54.43,  54.22,  54.00,    &
      53.77,  53.55,  53.32,  53.09,  52.87,  52.65,  52.43/
    data (si(i),i=897,1008) /                                   &
      52.20,  51.97,  51.75,  51.72,  51.68,  51.67,  51.67,    &
      51.48,  51.30,  51.11,  50.92,  50.73,  50.55,  50.37,    &
      50.18,  49.98,  49.79,  49.61,  49.43,  49.23,  49.04,    &
      48.85,  48.67,  48.48,  48.30,  48.12,  47.93,  47.73,    &
      47.54,  47.36,  47.18,  46.98,  46.79,  46.60,  46.42,    &
      46.24,  46.06,  45.87,  45.67,  45.48,  45.30,  45.12,    &
      44.93,  44.87,  44.82,  44.80,  44.79,  44.62,  44.45,    &
      44.29,  44.14,  43.98,  43.83,  43.66,  43.49,  43.34,    &
      43.18,  43.02,  42.86,  42.70,  42.55,  42.38,  42.21,    &
      42.06,  41.90,  41.74,  41.58,  41.42,  41.26,  41.10,    &
      40.94,  40.78,  40.62,  40.46,  40.31,  40.14,  39.97,    &
      39.81,  39.66,  39.50,  39.34,  39.18,  39.03,  38.99,    &
      38.96,  38.94,  38.92,  38.79,  38.66,  38.52,  38.38,    &
      38.25,  38.12,  37.99,  37.86,  37.72,  37.58,  37.44,    &
      37.30,  37.17,  37.05,  36.91,  36.77,  36.64,  36.50,    &
      36.36,  36.23,  36.09,  35.96,  35.82,  35.69,  35.55/
    data (si(i),i=1009,1120) /                                  &
      35.42,  35.28,  35.15,  35.01,  34.88,  34.75,  34.61,    &
      34.47,  34.34,  34.20,  34.07,  34.05,  34.03,  34.03,    &
      34.03,  33.91,  33.79,  33.68,  33.57,  33.46,  33.35,    &
      33.23,  33.12,  33.01,  32.90,  32.78,  32.67,  32.55,    &
      32.44,  32.33,  32.23,  32.11,  32.00,  31.89,  31.77,    &
      31.66,  31.55,  31.43,  31.31,  31.20,  31.10,  30.99,    &
      30.87,  30.76,  30.66,  30.54,  30.42,  30.31,  30.20,    &
      30.08,  29.97,  29.93,  29.90,  29.88,  29.87,  29.76,    &
      29.66,  29.56,  29.46,  29.36,  29.27,  29.17,  29.08,    &
      28.98,  28.88,  28.77,  28.67,  28.58,  28.49,  28.39,    &
      28.30,  28.20,  28.10,  28.00,  27.91,  27.81,  27.71,    &
      27.61,  27.52,  27.41,  27.31,  27.21,  27.12,  27.03,    &
      26.93,  26.83,  26.74,  26.64,  26.54,  26.44,  26.35,    &
      26.33,  26.31,  26.29,  26.28,  26.20,  26.12,  26.04,    &
      25.95,  25.87,  25.79,  25.71,  25.64,  25.54,  25.45,    &
      25.37,  25.30,  25.21,  25.12,  25.05,  24.98,  24.89/
    data (si(i),i=1121,1232) /                                  &
      24.80,  24.71,  24.63,  24.55,  24.47,  24.39,  24.31,    &
      24.22,  24.14,  24.05,  23.97,  23.89,  23.81,  23.73,    &
      23.66,  23.56,  23.47,  23.39,  23.31,  23.28,  23.26,    &
      23.23,  23.21,  23.13,  23.06,  22.99,  22.92,  22.84,    &
      22.76,  22.69,  22.63,  22.55,  22.47,  22.41,  22.35,    &
      22.27,  22.19,  22.11,  22.04,  21.97,  21.90,  21.83,    &
      21.76,  21.68,  21.60,  21.53,  21.47,  21.39,  21.31,    &
      21.24,  21.18,  21.11,  21.03,  20.96,  20.89,  20.81,    &
      20.73,  20.66,  20.60,  20.57,  20.55,  20.54,  20.53,    &
      20.46,  20.40,  20.34,  20.28,  20.21,  20.14,  20.08,    &
      20.03,  19.96,  19.90,  19.83,  19.77,  19.71,  19.65,    &
      19.59,  19.53,  19.46,  19.39,  19.33,  19.27,  19.21,    &
      19.15,  19.08,  19.02,  18.96,  18.90,  18.84,  18.78,    &
      18.71,  18.64,  18.58,  18.53,  18.46,  18.40,  18.33,    &
      18.27,  18.26,  18.25,  18.24,  18.24,  18.19,  18.14,    &
      18.08,  18.03,  17.98,  17.93,  17.88,  17.83,  17.77/
    data (si(i),i=1233,1344) /                                  &
      17.71,  17.66,  17.62,  17.56,  17.50,  17.45,  17.41,    &
      17.35,  17.29,  17.25,  17.21,  17.14,  17.08,  17.04,    &
      17.00,  16.93,  16.87,  16.83,  16.79,  16.72,  16.66,    &
      16.61,  16.57,  16.51,  16.46,  16.41,  16.36,  16.34,    &
      16.33,  16.31,  16.30,  16.26,  16.22,  16.17,  16.13,    &
      16.08,  16.04,  16.00,  15.96,  15.90,  15.84,  15.81,    &
      15.78,  15.73,  15.68,  15.63,  15.59,  15.55,  15.50,    &
      15.45,  15.40,  15.36,  15.32,  15.28,  15.24,  15.18,    &
      15.13,  15.09,  15.05,  15.01,  14.96,  14.91,  14.87,    &
      14.82,  14.78,  14.73,  14.69,  14.66,  14.64,  14.64,    &
      14.63,  14.59,  14.55,  14.50,  14.45,  14.41,  14.38,    &
      14.35,  14.32,  14.26,  14.21,  14.18,  14.15,  14.10,    &
      14.05,  14.01,  13.98,  13.94,  13.91,  13.86,  13.82,    &
      13.78,  13.74,  13.70,  13.67,  13.62,  13.58,  13.54,    &
      13.50,  13.46,  13.43,  13.39,  13.35,  13.30,  13.25,    &
      13.22,  13.18,  13.17,  13.16,  13.14,  13.12,  13.09/
    data (si(i),i=1345,1456) /                                  &
      13.06,  13.03,  13.00,  12.96,  12.92,  12.89,  12.85,    &
      12.81,  12.78,  12.74,  12.70,  12.67,  12.65,  12.61,    &
      12.57,  12.53,  12.50,  12.46,  12.43,  12.39,  12.36,    &
      12.32,  12.28,  12.25,  12.22,  12.18,  12.15,  12.11,    &
      12.07,  12.04,  12.01,  11.97,  11.94,  11.90,  11.86,    &
      11.85,  11.85,  11.85,  11.84,  11.81,  11.78,  11.75,    &
      11.72,  11.69,  11.66,  11.63,  11.60,  11.58,  11.55,    &
      11.51,  11.47,  11.45,  11.42,  11.39,  11.36,  11.33,    &
      11.30,  11.27,  11.24,  11.21,  11.18,  11.15,  11.12,    &
      11.09,  11.06,  11.03,  11.00,  10.97,  10.94,  10.91,    &
      10.89,  10.85,  10.82,  10.78,  10.75,  10.73,  10.72,    &
      10.71,  10.70,  10.67,  10.64,  10.62,  10.59,  10.55,    &
      10.52,  10.50,  10.47,  10.44,  10.42,  10.39,  10.37,    &
      10.34,  10.31,  10.28,  10.25,  10.22,  10.20,  10.17,    &
      10.15,  10.12,  10.10,  10.06,  10.03,  10.00,   9.98,    &
       9.95,   9.92,   9.89,   9.86,   9.84,   9.82,   9.79/
    data (si(i),i=1457,1501) /                                  &
       9.75,   9.73,   9.71,   9.70,   9.70,   9.70,   9.70,    &
       9.67,   9.63,   9.61,   9.59,   9.58,   9.56,   9.53,    &
       9.50,   9.48,   9.45,   9.43,   9.41,   9.39,   9.36,    &
       9.34,   9.32,   9.30,   9.27,   9.24,   9.22,   9.20,    &
       9.18,   9.15,   9.13,   9.11,   9.08,   9.06,   9.05,    &
       9.02,   8.99,   8.96,   8.94,   8.92,   8.90,   8.87,    &
       8.85,   8.83,   8.81/
    pas=0.0025
    iwl=int((wl-0.250)/pas+1.5)
    if(iwl.lt.0) goto 10
    swl=si(iwl)
    return
10  write(iwr, 20)
    swl=si(1)
20  format(45h      wavelength  less  than  0.25  micron  :,/,23hlet's take s(l)=s(0.25))
    return
end
